typecheck 'Semantics : 'Semantics

syntax {
  'Nat = ['EnumOrTag ['Zero] [['Suc 'Nat]]]
}

typecheck 'Nat : 'Semantics
typecheck 'Zero : 'Nat
typecheck ['Suc 'Zero] : 'Nat

typecheck ['Pi 'Nat (\_.'Nat)] : 'Semantics
typecheck \x.x : ['Pi 'Nat (\_.'Nat)]
typecheck \x.'Zero : ['Pi 'Nat \_.'Nat]

typecheck ['Pi 'Semantics \X.['Pi X \_.X]] : 'Semantics
typecheck \X x.x : ['Pi 'Semantics \X.['Pi X \_.X]]

operator
  { 'Nat -[ 'mul 'Nat ] : 'Nat
  ; 'Nat -[ 'add 'Nat ] : 'Nat
  }

-- TODO: improve error message for:
-- \x.'Zero : ['Pi 'Nat \_.'Nat] -[ 'mul m ] ~> 'Zero

'Zero : 'Nat -[ 'mul n ] ~> 'Zero
['Suc m] : 'Nat -[ 'mul n ] ~> n -['add m -['mul n]]

'Zero : 'Nat -[ 'add n ] ~> n
['Suc m] : 'Nat -[ 'add n ] ~> ['Suc m -['add n]]

operator
  { ['Pi a \x.b] -['apply (t : a)] : {x=t}b }

-- TODO: get capture working?
-- operator { ['Pi a \x.b] -['apply (x : a)] : b }

\x.'Zero : ['Pi 'Nat \_.'Nat] -[ 'apply t ] ~> 'Zero



exec PRINTF "Hurrah!".
